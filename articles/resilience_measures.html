<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EWSmethods">
<title>Alternative Resilience Measures • EWSmethods</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alternative Resilience Measures">
<meta property="og:description" content="EWSmethods">
<meta property="og:image" content="https://duncanobrien.github.io/EWSmethods/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EWSmethods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ews_assessments.html">Performing Early Warning Signal Assessments</a>
    <a class="dropdown-item" href="../articles/resilience_measures.html">Alternative Resilience Measures</a>
    <a class="dropdown-item" href="../articles/using_ewsnet.html">Using EWSNet</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/duncanobrienn" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/duncanobrien/EWSmethods/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Alternative Resilience Measures</h1>
                        <h4 data-toc-skip class="author">Duncan
O’Brien</h4>
            
            <h4 data-toc-skip class="date">2023-04-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/duncanobrien/EWSmethods/blob/HEAD/vignettes/resilience_measures.Rmd" class="external-link"><code>vignettes/resilience_measures.Rmd</code></a></small>
      <div class="d-none name"><code>resilience_measures.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about-this-tutorial">About this tutorial<a class="anchor" aria-label="anchor" href="#about-this-tutorial"></a>
</h2>
<p>This tutorial introduces resilience metrics distinct from critical
slowing down based/Early Warning Signal indicators. The primary benefit
of this collection of techniques is that they are both model and
equilibrium free; they don’t assume a system is a equilibrium.</p>
<p><code>EWSmethods</code> provides three distinct approaches to
quantifying system resilience. The tutorial will go through each in turn
and give examples of their usage.</p>
<p>Greater detail on each function can be found at the <a href="https://duncanobrien.github.io/EWSmethods/reference/index.html">Reference</a>
page.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co">#to ensure reproducible data</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/duncanobrien/EWSmethods" class="external-link">EWSmethods</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co">#for plotting</span></span></code></pre></div>
<p>We will use the same multi-species community described in the <a href="https://duncanobrien.github.io/EWSmethods/articles/ews_assessments.html">Performing
Early Warning Signal Assessments</a> tutorial.</p>
<p>Briefly, the data object <code>"simTransComms"</code> contains three
replicate datasets of a simulated five species community that has been
driven to transition by the introduction of an invasive species
(following Dakos 2018). The strength of impact by the invasive species
gradually increases through time between <em>t100</em> and <em>t200</em>
at which point it is held constant.</p>
<p>Lets load the data in:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simTransComms"</span><span class="op">)</span></span></code></pre></div>
<p>and plot one of the communities. The vertical dashed line represents
a sudden transition due to the invasive species.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>,  main <span class="op">=</span> <span class="st">"Transitioning five species community"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">$</span><span class="va">inflection_pt</span>,col <span class="op">=</span> <span class="st">"grey60"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="resilience_measures_files/figure-html/vis_data-1.png" width="1050"></p>
<p>Now we have a system/community that is experiencing some form of
stress and we can apply univariate or multivariate resilience measures
to give us an idea of how the system is responding to that stress.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="index-of-variability">1) Index of Variability<a class="anchor" aria-label="anchor" href="#index-of-variability"></a>
</h2>
<p>The simplest measure provided by <code>EWSmethods</code> is the
multivariate index of variability (MVI - Brock and Carpenter, 2006). The
MVI is represented by the square root of the dominant eigenvalue of the
covariance matrix of all species.</p>
<p><br></p>
<div class="section level4">
<h4 id="interpretation">
<em>Interpretation</em><a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h4>
<p>Increasing MVI represents decreasing stability.</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="usage">
<em>Usage</em><a class="anchor" aria-label="anchor" href="#usage"></a>
</h4>
<p>Provide the community data (first column being time, the remainder
being species values) to the <code><a href="../reference/mvi.html">mvi()</a></code> function, and specify a
<code>winsize</code> to calculate the index over. The default
<code>winsize</code> is 50% the total length of the time series, but we
have set <code>winsize = 25</code> to ensure that the periods before and
after the sudden change in are distinct.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">egMVI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvi.html">mvi</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, winsize <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p>If we then plot the index, we can see that before and after the
‘inflection point’ (where the community goes through a transition) there
are clear differences in stability.</p>
<p>What is also apparent is that the MVI begins to increase prior to the
sudden change, albeit only slightly.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mvi_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">egMVI</span><span class="op">)</span>,by<span class="op">=</span><span class="st">"time"</span><span class="op">)</span> <span class="co"># combine the mvi data with the raw time series</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mvi_plot_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">mvi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">mvi_plot_data</span><span class="op">$</span><span class="va">inflection_pt</span>,col <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"MVI value"</span><span class="op">)</span></span></code></pre></div>
<p><img src="resilience_measures_files/figure-html/mvi2-1.png" width="1050"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="caveats">
<em>Caveats</em><a class="anchor" aria-label="anchor" href="#caveats"></a>
</h4>
<p>The MVI only quantifies the variability of the community rather than
changing relationships between community components. It is therefore
susceptible to data quality, the inherent stochasticity of the system,
and rate of forcing.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="s-map-jacobians">2) S-map Jacobians<a class="anchor" aria-label="anchor" href="#s-map-jacobians"></a>
</h2>
<p>The cutting edge of resilience metrics belong to approaches which
exploit empirical dynamic modelling (EDM - Sugihara <em>et al.</em>
2012). EDM exploits Takens’ embedding theorem (Takens 1981) which
suggests that an underlying latent system/attractor manifold can be
reconstructed from one or more related time series. By lag embedding two
or more time series, their interaction strength (or causal strength) can
be estimated.</p>
<p>This approach consequently requires no knowledge of the underlying
equations nor numerical estimates of the system’s equilibrium state as
the local Jacobians are directly estimated from the time series. The
local Lyapunov stability is calculated as the dominant eigenvalue of the
estimated Jacobian matrix.</p>
<p>Jacobians consist of the first-order partial derivatives for a
multivariate function and are critical to resilience quantification.
They are so important because they allow us to differentiate two or more
functions with respect to two or more variables, something not
achievable using standard derivation. Jacobian matrices therefore
provide insight in to how each variable (or species) in a system’s
master equation will change in the successive time step; if we know the
true Jacobian, we know the future.</p>
<p><code>EWSmethods</code> provides access to two forms of s-map
estimated Jacobians, one for univariate data (following Grziwotz <em>et
al.</em> 2023) and another for multivariate data (following Ushio <em>et
al.</em> 2018).</p>
<p><br></p>
<div class="section level4">
<h4 id="interpretation-1">
<em>Interpretation</em><a class="anchor" aria-label="anchor" href="#interpretation-1"></a>
</h4>
<p>A local Lyapunov stability value (the returned index value) of less
than <code>1</code> indicates that the community tends to recover faster
from perturbations, assuming the interspecific interaction strengths and
self-regulation effects are constant. Therefore, <code>1</code>
represents a threshold above which the system is unstable and below
which the system is stable. However, any persistent increase in Jacobian
index is of concern for resilience loss.</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="usage---univariate">
<em>Usage - Univariate</em><a class="anchor" aria-label="anchor" href="#usage---univariate"></a>
</h4>
<p>The univariate form of Jacobian estimated stability is performed
using the <code><a href="../reference/uniJI.html">uniJI()</a></code> function. Following Grziwotz <em>et
al.</em> (2023), <code><a href="../reference/uniJI.html">uniJI()</a></code> estimates the strength of time
embedded relationship between a univariate time series and lagged forms
of itself.</p>
<p>In <code><a href="../reference/uniJI.html">uniJI()</a></code>, we again provide community data but for a
single species (first column being time, focal species the second). We
must also provide a <code>winsize</code>, embedding dimension
(<code>E</code>) and <code>tau</code>. <code>E</code> and
<code>tau</code> are complicated to parameterise and requires a degree
of exploration. Initially, we suggest <code>E</code> to be in the range
1 to 6, and <code>tau</code> in the range 3 - 12, but refer readers to
the excellent introduction by Chang <em>et al.</em> (2017) for further
details.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eg_uniJI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uniJI.html">uniJI</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, winsize <span class="op">=</span> <span class="fl">25</span>, E <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the index for this species, we observe a loss of stability
prior to the transition and dramatic overcompensation following it.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uniJI_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span>,<span class="va">eg_uniJI</span>,by<span class="op">=</span><span class="st">"time"</span><span class="op">)</span> <span class="co"># combine the mvi data with the raw time series</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">uniJI_plot_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">smap_J</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">uniJI_plot_data</span><span class="op">$</span><span class="va">inflection_pt</span>,col <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Univariate stability index value"</span><span class="op">)</span></span></code></pre></div>
<p><img src="resilience_measures_files/figure-html/uniJI2-1.png" width="1050"></p>
<p>Lets repeat this for all species to give us an overall idea of system
resilience.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_spp_uniJI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"spp_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">)</span><span class="op">)</span>,FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/uniJI.html">uniJI</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">x</span><span class="op">)</span><span class="op">]</span>, winsize <span class="op">=</span> <span class="fl">25</span>, E <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/uniJI.html">uniJI</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">x</span><span class="op">)</span><span class="op">]</span>, winsize <span class="op">=</span> <span class="fl">25</span>, E <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="co"># for each species, calculate the univariate stability index</span></span>
<span></span>
<span><span class="va">all_spp_uniJI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"cbind"</span>,<span class="va">all_spp_uniJI</span><span class="op">)</span> <span class="co"># merge the list in to a data.frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">all_spp_uniJI</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"spp"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span><span class="op">)</span> <span class="co"># and rename missing columns</span></span>
<span></span>
<span><span class="va">all_spp_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">all_spp_uniJI</span>,cols <span class="op">=</span> <span class="op">-</span><span class="va">time</span>,names_to <span class="op">=</span> <span class="st">"species"</span>,values_to <span class="op">=</span> <span class="st">"smap_J"</span><span class="op">)</span>, <span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"inflection_pt"</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="co">#pivot_longer for easier plotting and merge with the inflection point data</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_spp_plot_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">smap_J</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">all_spp_plot_data</span><span class="op">$</span><span class="va">inflection_pt</span>,col <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Univariate stability index value"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"#6886c4"</span>,<span class="st">"#bfbd3d"</span>,<span class="st">"#69c756"</span>,<span class="st">"#e281fe"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span></span></code></pre></div>
<p><img src="resilience_measures_files/figure-html/uniJI_comp-1.png" width="700"></p>
<p>This approach highlights how each species responds uniquely and can
help identify the most sensitive species. I.e which are possible
indicator species.</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="usage---multivariate">
<em>Usage - Multivariate</em><a class="anchor" aria-label="anchor" href="#usage---multivariate"></a>
</h4>
<p>Conversely, to compute the multivariate form of Jacobian estimation,
we can use the function <code><a href="../reference/multiJI.html">multiJI()</a></code>. <code><a href="../reference/multiJI.html">multiJI()</a></code>
fits a local linear model between all species which predicts the
system’s future value from the reconstructed state-space. The resulting
coefficients of this model are therefore a proxy for the interaction
strength between species.</p>
<p>Note <code>E</code> and <code>tau</code> are not required for the
<code>EWSmethods</code> form of index. For <code>E</code>, the number of
species themselves are used for embedding, though this does limit the
minimum length of time series to being the number of species. Instead,
<code>theta</code> is impactful, and represents the tuning parameter for
forecasts (if not provided, <code><a href="../reference/multiJI.html">multiJI()</a></code> identifies the
optimal <code>theta</code> using root mean square error). Conversely,
<code>tau</code> is held constant at <code>-1</code> as there is no self
embedding due to the index being a multivariate measure.</p>
<blockquote>
<p>⚠️ <strong>Warning!</strong> - <em><code><a href="../reference/multiJI.html">multiJI()</a></code> is
significantly slower than any of the other resilience indicators
provided by <code>EWSMethods</code> due to the multiple cross
referencing required between species. Therefore increasing the number of
species and length of time series (or decreasing <code>winsize</code>)
can dramatically increase computation time</em>.</p>
</blockquote>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eg_multiJI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiJI.html">multiJI</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, winsize <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the index for this species, we observe a loss of stability
significantly prior to the transition and much earlier than the
<code><a href="../reference/uniJI.html">uniJI()</a></code> estimated index.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multiJI_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span>,<span class="va">eg_multiJI</span>,by<span class="op">=</span><span class="st">"time"</span><span class="op">)</span> <span class="co"># combine the mvi data with the raw time series</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">multiJI_plot_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">smap_J</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">multiJI_plot_data</span><span class="op">$</span><span class="va">inflection_pt</span>,col <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Mulivariate stability index value"</span><span class="op">)</span></span></code></pre></div>
<p><img src="resilience_measures_files/figure-html/multiJI2-1.png" width="1050"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="caveats-1">
<em>Caveats</em><a class="anchor" aria-label="anchor" href="#caveats-1"></a>
</h4>
<p>Both s-map methods are sensitive to the choice of <code>E</code> and
<code>tau</code>. Additionally, in seasonal/cyclical data, the shared
cycles or seasons across species can artificially inflate estimates of
causality and relatedness. In these circumstances, it is recommended to
detrend data prior to estimating these resilience metrics (Ushio <em>et
al.</em> 2018). <code>EWSmethods</code> provides the capability to
detrend and deaseason data via the functions <code><a href="../reference/detrend_ts.html">detrend_ts()</a></code>
and <code><a href="../reference/deseason_ts.html">deseason_ts()</a></code> respectively. Similarly, it is sensible
to scale/normalise all time series to be of equivalent magnitude to aid
model fitting. A <code>scale = TRUE</code> argument is present in both
<code><a href="../reference/uniJI.html">uniJI()</a></code> and <code><a href="../reference/multiJI.html">multiJI()</a></code> to achieve this.</p>
<p>Additionally, the two approaches require time series with no extended
period of unchanging values (specifically a period equal to or longer
than the window size). If <code><a href="../reference/uniJI.html">uniJI()</a></code> or <code><a href="../reference/multiJI.html">multiJI()</a></code>
detect such a circumstance, the current iteration returns
<code>NA</code> and the time series is removed respectively. For
<code><a href="../reference/multiJI.html">multiJI()</a></code> if there are more species than data points in the
window, then the index will fail. This is due to a multivariate index
calculated across <code>n</code> species time delays up to lag
<code>n-1</code>, which may not be possible if the time series are
short. In this circumstance, we recommend sampling a subset of species,
either randomly or the most abundance species (those less likely to have
a period of unchanging values).</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="fisher-information">3) Fisher Information<a class="anchor" aria-label="anchor" href="#fisher-information"></a>
</h2>
<p>Fisher Information (FI) attempts to estimate the amount of
information data can provide on an unmeasured parameter (Fisher and
Russell 1922). It consequently has been applied as an indicator of
system dynamics and stability (Ahmad et al. 2016).
<code>EWSmethods</code> provides a simplified discrete time form of
Fisher and Russel (1922)’s mathematic proof following Karunanithi <em>et
al.</em> (2008):</p>
<p><span class="math display">\[\begin{equation}
FI\approx 4 \sum_{i=1}^{m}[q_i-q_{(i+1)}]^2
\end{equation}\]</span></p>
<p>where <span class="math inline">\(q_{i}^2\)</span> is the amplitude
of the probability of observing states of the system at time window
<span class="math inline">\(i\)</span> and <span class="math inline">\(m\)</span> is the number of possible ‘states’.
Possible states are defining by comparing the difference between
temporally adjacent data windows to a reference ‘uncertainty’. If the
absolute difference in density is less than the reference deviation for
all variables (i.e. species densities), then the windows are binned in
to the same ‘state’.</p>
<p><br></p>
<div class="section level4">
<h4 id="interpretation-2">
<em>Interpretation</em><a class="anchor" aria-label="anchor" href="#interpretation-2"></a>
</h4>
<p>Decreasing FI represents decreasing stability.</p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="usage-1">
<em>Usage</em><a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h4>
<p>Provide the community data (first column being time, the remainder
being species values) to the <code><a href="../reference/FI.html">FI()</a></code> function, specify a
<code>winsize</code> to calculate the index over, and a size-of-states
vector (<code>sost</code>). The default <code>winsize</code> is 50% the
total length of the time series, and <code>sost</code> is typically
suggested to be the standard deviation of each species across the entire
time series multiplied by 2 (Karunanithi et al. 2008).
<code>winspace</code> indicates the number of data points to slide the
rolling window along (<code>1</code> is standard) and <code>TL</code> is
the ‘tightening level’. <code>TL</code> is the percentage of points
shared between states and allows the algorithm to classify data points
to/from the same state.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eg.sost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span> <span class="co"># define size-of-states using the standard deviation of each species separately. Must be wide format hence t()</span></span>
<span></span>
<span><span class="va">egFI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FI.html">FI</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, sost <span class="op">=</span>  <span class="va">eg.sost</span>, winsize <span class="op">=</span> <span class="fl">25</span>,winspace <span class="op">=</span> <span class="fl">1</span>, TL <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">$</span><span class="va">FI</span></span></code></pre></div>
<p>If we again plot the index, we can see that before and after the
‘inflection point’ (where the community goes through a transition) there
are clear differences in stability.</p>
<p>What is also apparent, is that the FI begins to decrease prior to the
sudden change, and stability only returns after an extended period post
constant stress (stress is constant from <em>t200</em> onward).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fi_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">simTransComms</span><span class="op">$</span><span class="va">community1</span>,<span class="va">egFI</span>,by<span class="op">=</span><span class="st">"time"</span><span class="op">)</span> <span class="co"># combine the mvi data with the raw time series</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fi_plot_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">FI</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">fi_plot_data</span><span class="op">$</span><span class="va">inflection_pt</span>,col <span class="op">=</span> <span class="st">"grey60"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Fisher Information value"</span><span class="op">)</span></span></code></pre></div>
<p><img src="resilience_measures_files/figure-html/fi2-1.png" width="1050"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="caveats-2">
<em>Caveats</em><a class="anchor" aria-label="anchor" href="#caveats-2"></a>
</h4>
<p>FI is very sensitive to the size-of-states and tightening level.
There is also no threshold of stable vs unstable as it is the relative
change of FI that is important, not the absolute value.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Ahmad N., Derrible S., Eason T., and Cabezas H. (2016) Using Fisher
information to track stability in multivariate systems. <em>Royal
Society Open Science</em>. 3, 11, 160582. <a href="https://royalsocietypublishing.org/doi/10.1098/rsos.160582" class="external-link">doi:
10.1098/rsos.160582</a></p>
<p>Brock, W., &amp; Carpenter, S. (2006). Variance as a leading
indicator of regime shift in ecosystem services. <em>Ecology and
Society</em>, 11, 9. <a href="https://www.ecologyandsociety.org/vol11/iss2/art9/" class="external-link">http://www.ecologyandsociety.org/vol11/iss2/art9/</a></p>
<p>Chang, C.-W., Ushio, M., and Hsieh, C.-h. (2017). Empirical Dynamic
Modeling for beginners. <em>Ecological Research</em>, 32,6,785–796. <a href="https://esj-journals.onlinelibrary.wiley.com/doi/full/10.1007/s11284-017-1469-9" class="external-link">doi:10.1007/s11284-017-1469-9</a></p>
<p>Fisher, R. A., &amp; Russell, E. J. (1922). On the mathematical
foundations of theoretical statistics. <em>Philosophical Transactions of
the Royal Society of London Series A: Containing Papers of a
Mathematical or Physical Character</em>, 222, 309–368. <a href="https://royalsocietypublishing.org/doi/10.1098/rsta.1922.0009" class="external-link">doi:10.1098/rsta.1922.0009</a></p>
<p>Grziwotz, F., Chang, C.-W., Dakos, V., et al. (2023). Anticipating
the occurrence and type of critical transitions. <em>Science
Advances</em>, 9. <a href="https://www.science.org/doi/10.1126/sciadv.abq4558" class="external-link">doi:10.1126/sciadv.abq4558</a></p>
<p>Karunanithi, A. T., Cabezas, H., Frieden, et al. (2008). Detection
and assessment of ecosystem regime shifts from Fisher Information.
<em>Ecology and Society</em>, 13, 1. <a href="https://www.jstor.org/stable/26267924" class="external-link">https://www.jstor.org/stable/26267924</a></p>
<p>Sugihara, G., May, R., Ye, H., Hsieh, C., Deyle, E., Fogarty, M.,
&amp; Munch, S. (2012). Detecting causality in complex ecosystems.
<em>Science</em>, 338, 496–500. <a href="https://www.science.org/doi/10.1126/science.1227079" class="external-link">doi:10.1126/science.1227079</a></p>
<p>Takens, F. (1981). Detecting strange attractors in turbulence.
<em>Dynamical Systems and Turbulence</em>, Warwick 1980. Ed. by D. Rand
and L.-S. Young. Berlin, Heidelberg: Springer Berlin Heidelberg,
pp. 366–381</p>
<p>Ushio, M., Hsieh, Ch., Masuda, R. et al. (2018) Fluctuating
interaction network and time-varying stability of a natural fish
community. <em>Nature</em>, 554, 360–363. <a href="https://www.nature.com/articles/nature25504" class="external-link">doi:10.1038/nature25504</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Duncan O’Brien, Smita Deb, Sahil Sidheekh, Narayanan Krishnan, Partha Dutta, Christopher Clements.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
