<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Rolling and expanding window approaches to assessing abundance based early warning signals. ggplot based presentation of the outputs are also provided for clear and publishable figures.">
<title>Simple Early Warning Signals for Univariate and Multivariate Time Series • EWSmethods</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simple Early Warning Signals for Univariate and Multivariate Time Series">
<meta property="og:description" content="Rolling and expanding window approaches to assessing abundance based early warning signals. ggplot based presentation of the outputs are also provided for clear and publishable figures.">
<meta property="og:image" content="https://duncanobrien.github.io/EWSmethods/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">EWSmethods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/using_ewsnet.html">Using EWSNet</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/duncanobrienn" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/duncanobrien/EWSmethods/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="ewsmethods-">EWSmethods 
<a class="anchor" aria-label="anchor" href="#ewsmethods-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- badges: end --><p><code>EWSmethods</code> is a user friendly interface to various methods of performing Early Warning Signal (EWS) assessments. This R package allows the user to input univariate or multivariate data and perform either traditional rolling window (e.g. Dakos <em>et al.</em> 2012) or expanding window (Drake and Griffin, 2010) EWS approaches. Publication standard and ggplot inspired figures can also be generated during this process. <code>EWSmethods</code> also provides an R interface to <a href="https://ewsnet.github.io" class="external-link"><strong>EWSNet</strong></a>, a deep learning modelling framework for predicting critical transitions (Deb <em>et al.</em> 2022).</p>
<p><br></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>EWSmethods</code> from <a href="https://github.com/duncanobrien/EWSmethods" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="co"># devtools::install_github("duncanobrien/EWSmethods")</span></span></code></pre></div>
<p><strong>Be aware, due to the large file sizes of the EWSNet model weights, the size of the package is ~100MB.</strong></p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/duncanobrien/EWSmethods" class="external-link">EWSmethods</a></span><span class="op">)</span></span></code></pre></div>
<p>The remainder of this page will introduce the two primary ways of interacting with <code>EWSmethods</code> for your critical transition forecasting needs. For specific function help, please refer to the <a href="https://duncanobrien.github.io/EWSmethods/reference/index.html">Reference</a> page.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="1-early-warning-signals">1. Early Warning Signals<a class="anchor" aria-label="anchor" href="#1-early-warning-signals"></a>
</h2>
<p>Early warning signals are a collection of summary statistics that attempt to characterise the phenomenon of <strong>critical slowing down (CSD)</strong>. As a system approaches a tipping point (or bifurcation), it takes longer and longer for it to recover when it is pushed away from stability (Dakos <em>et al.</em> 2012). This increased <strong>return rate</strong> is a manifestation of CSD and can be detectable in data. <code>EWSmethods</code> provides a collection of these summary statistics which can be calculated from either univariate or multivariate time series using <code><a href="reference/uniEWS.html">uniEWS()</a></code> and <code><a href="reference/multiEWS.html">multiEWS()</a></code> respectively.</p>
<p><br></p>
<div class="section level3">
<h3 id="the-univariate-approach">The univariate approach<a class="anchor" aria-label="anchor" href="#the-univariate-approach"></a>
</h3>
<p>Imagine we have 50 years of monitoring data for a local population of skylarks (<em>Alauda arvensis</em>) and have measured mean body mass data throughout this period as well.</p>
<p>We could calculate either rolling or expanding window EWSs using the abundance data via <code><a href="reference/uniEWS.html">uniEWS()</a></code> but decide to initially focus on rolling windows. We would therefore parameterise the function to do so as below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">125</span><span class="op">)</span> <span class="co">#seed to ensure reproducible results</span></span>
<span></span>
<span><span class="va">skylark_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>, abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,mean <span class="op">=</span> <span class="fl">100</span>,sd<span class="op">=</span><span class="fl">20</span><span class="op">)</span>, trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,mean<span class="op">=</span><span class="fl">40</span>,sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co">#dummy skylark dataset</span></span>
<span></span>
<span><span class="va">ews_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SD"</span>,<span class="st">"ar1"</span>,<span class="st">"skew"</span><span class="op">)</span> <span class="co">#the early warning signal metrics we wish to compute</span></span>
<span></span>
<span><span class="va">roll_ews</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/uniEWS.html">uniEWS</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">skylark_data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, metrics <span class="op">=</span>  <span class="va">ews_metrics</span>, method <span class="op">=</span> <span class="st">"rolling"</span>, winsize <span class="op">=</span> <span class="fl">50</span>, ggplotIt <span class="op">=</span><span class="cn">TRUE</span>,  y_lab <span class="op">=</span> <span class="st">"Skylark abundance"</span><span class="op">)</span> <span class="co">#lets use a rolling window approach</span></span>
<span></span>
<span><span class="va">roll_ews</span><span class="op">$</span><span class="va">EWS</span><span class="op">$</span><span class="va">cor</span> <span class="co">#return the Kendall Tau correlations for each EWS metric</span></span>
<span><span class="co">#&gt;            SD        ar1       skew</span></span>
<span><span class="co">#&gt; tau 0.5446154 -0.3907692 -0.7046154</span></span></code></pre></div>
<p>We can then use the resulting figures to identify oncoming transitions. In this case, we expect no transition as the data is randomly sampled from a normal distribution and this is evident in the Kendall Tau values, with no strong positive correlation with time:</p>
<p><img src="reference/figures/README-rolling_plot-1.png" width="100%"></p>
<p>Alternatively, we may be more interested in expanding windows as that approach standardises the changing EWS metrics over time and therefore allows the strength of multiple signals to be combined. We could achieve this using the following code:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_ews</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/uniEWS.html">uniEWS</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">skylark_data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, metrics <span class="op">=</span>  <span class="va">ews_metrics</span>, method <span class="op">=</span> <span class="st">"expanding"</span>, burn_in <span class="op">=</span> <span class="fl">10</span>, threshold <span class="op">=</span> <span class="fl">2</span>,  tail.direction <span class="op">=</span> <span class="st">"one.tailed"</span>, ggplotIt <span class="op">=</span><span class="cn">TRUE</span>, y_lab <span class="op">=</span> <span class="st">"Skylark abundance"</span><span class="op">)</span> <span class="co">#lets use a rolling window approach</span></span>
<span><span class="co">#&gt; Warning: Removed 7 row(s) containing missing values (geom_path).</span></span>
<span><span class="co">#&gt; Warning: Removed 7 rows containing missing values (geom_point).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">exp_ews</span><span class="op">$</span><span class="va">EWS</span><span class="op">)</span> <span class="co">#return the head of the EWS dataframe</span></span>
<span><span class="co">#&gt;   time metric.score metric.code rolling.mean rolling.sd threshold.crossed</span></span>
<span><span class="co">#&gt; 1   10    0.0000000         ar1    0.0000000         NA                 0</span></span>
<span><span class="co">#&gt; 2   11   -0.7071068         ar1   -0.3535534  0.5000000                 0</span></span>
<span><span class="co">#&gt; 3   12   -0.9223669         ar1   -0.5431579  0.4825449                 0</span></span>
<span><span class="co">#&gt; 4   13   -0.1500572         ar1   -0.4448827  0.4403012                 0</span></span>
<span><span class="co">#&gt; 5   14    0.8428688         ar1   -0.1873324  0.6906950                 0</span></span>
<span><span class="co">#&gt; 6   15   -1.8668306         ar1   -0.4672488  0.9229121                 0</span></span>
<span><span class="co">#&gt;   count.used        str</span></span>
<span><span class="co">#&gt; 1  108.91249         NA</span></span>
<span><span class="co">#&gt; 2   93.56813 -0.7071068</span></span>
<span><span class="co">#&gt; 3  109.56960 -0.7858522</span></span>
<span><span class="co">#&gt; 4  103.92341  0.6695997</span></span>
<span><span class="co">#&gt; 5  114.29655  1.4915428</span></span>
<span><span class="co">#&gt; 6   80.79726 -1.5164845</span></span></code></pre></div>
<p>And again, we can then use the resulting figures to identify oncoming transitions. Whilst we have some trangressions of the 2σ threshold, we only consider these signals “warnings” if two or more consecutive signals are identified (Clements <em>et al.</em> 2019).</p>
<p><img src="reference/figures/README-expanding_plot-1.png" width="100%"></p>
<p>A second benefit of the expanding window approach is that additional information can be used to improve the reliability of the assessment. Including trait information has been shown to decrease the likelihood of both false positive and false negative signals (Clements and Ozgul, 2016; Baruah <em>et al.</em> 2019) and therefore should be considered if possible.</p>
<p>For example, in our hypothetical skylark dataset, we have measured average population body mass. This data can then be delivered to the <code>univariate_EWS_wrapper()</code> function in <code>EWSmethods</code>, using the <code>trait</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trait_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SD"</span>, <span class="st">"ar1"</span>, <span class="st">"trait"</span><span class="op">)</span></span>
<span><span class="va">exp_ews_trait</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/uniEWS.html">uniEWS</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">skylark_data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, metrics <span class="op">=</span>  <span class="va">trait_metrics</span>, method <span class="op">=</span> <span class="st">"expanding"</span>, burn_in <span class="op">=</span> <span class="fl">10</span>, threshold <span class="op">=</span> <span class="fl">2</span>, tail.direction <span class="op">=</span> <span class="st">"one.tailed"</span>, ggplotIt <span class="op">=</span><span class="cn">TRUE</span>, y_lab <span class="op">=</span> <span class="st">"Skylark abundance"</span>,</span>
<span>trait <span class="op">=</span> <span class="va">skylark_data</span><span class="op">$</span><span class="va">trait</span>, trait_lab <span class="op">=</span> <span class="st">"Body mass (g)"</span>, trait_scale <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 7 row(s) containing missing values (geom_path).</span></span>
<span><span class="co">#&gt; Warning: Removed 7 rows containing missing values (geom_point).</span></span></code></pre></div>
<p><img src="reference/figures/README-expanding_plot_trait-1.png" width="100%"></p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="the-multivariate-approach">The multivariate approach<a class="anchor" aria-label="anchor" href="#the-multivariate-approach"></a>
</h3>
<p>If we had data from multiple timeseries/measurements of the same system, we might be interested in multivariate early warning signals. These indicators exploit either dimension reduction techniques (such as Principal Component Analysis) or community average estimates to give an overall measure of system resilience (see Weinans <em>et al.</em> 2021 for an overview of each indicator).</p>
<p>Here we’ve constructed another hypothetical dataset representing five related populations of Caribbean reef octopus (<em>Octopus briareus</em>) in Bahamian salt water lakes (O’Brien <em>et al.</em> 2020) and are interested in assessing the resilience of this metapopulation. The following code shows how we would achieve this using the <code>EWSmethods</code> function <code><a href="reference/multiEWS.html">multiEWS()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">octopus_spp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">50</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">octopus_spp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"time"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">octopus_spp_data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">octopus_spp_data</span><span class="op">[</span>,<span class="va">x</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,mean<span class="op">=</span><span class="fl">500</span>,sd<span class="op">=</span><span class="fl">200</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#create our hypothetical, uncollapsing ecosystem</span></span>
<span></span>
<span><span class="va">oct_exp_ews</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/multiEWS.html">multiEWS</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">octopus_spp_data</span>, method <span class="op">=</span> <span class="st">"expanding"</span>, threshold <span class="op">=</span> <span class="fl">2</span>, tail.direction <span class="op">=</span> <span class="st">"one.tailed"</span>, ggplotIt <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#lets use an expanding window approach</span></span>
<span><span class="co">#&gt; Warning: Removed 24 row(s) containing missing values (geom_path).</span></span>
<span><span class="co">#&gt; Warning: Removed 24 rows containing missing values (geom_point).</span></span></code></pre></div>
<p>The figure again shows that one multivariate EWS indicator has expressed a warning, but that overall, no transition is anticipated.</p>
<p><img src="reference/figures/README-expanding_oct_plot-1.png" width="100%"></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="2-ewsnet">2. EWSNet<a class="anchor" aria-label="anchor" href="#2-ewsnet"></a>
</h2>
<p>The other half of <code>EWSmethods</code> allows you to query the <a href="https://www.python.org" class="external-link">Python-based</a> <strong>EWSNet</strong> via an easy to use R workflow. Here is a simple example that details how to first prepare your R session to communicate with Python (using the excellent <code>reticulate</code> <a href="https://rstudio.github.io/reticulate/" class="external-link">R package</a>) and then calls <strong>EWSNet</strong> to assess the probability of a transition occurring in the skylark time series. This is a two step process where we must a) call <code><a href="reference/EWSNET_init.html">ewsnet_init()</a></code> before b) using <code><a href="reference/ewsnet_predict.html">ewsnet_predict()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/bypass_reticulate_autoinit.html">bypass_reticulate_autoinit</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#edits your global R environment with the line: RETICULATE_AUTOCONFIGURE = "FALSE". This ensures 'reticulate' does not load a python environment until 'ewsnet_init()' has been called</span></span>
<span><span class="co">#&gt; RETICULATE_AUTOCONFIGURE already set to FALSE</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/EWSNET_init.html">ewsnet_init</a></span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"EWSNET_env"</span><span class="op">)</span> <span class="co">#prepares your workspace using 'reticulate' and asks to install Anaconda (if no appropriate Python found) and/or a Python environment before activating that environment with the necessary Python packages</span></span>
<span><span class="co">#&gt; conda env EWSNET_env found. Would you like to activate it and install necessary</span></span>
<span><span class="co">#&gt; packages? (y/n)</span></span>
<span><span class="co">#&gt; Aborting</span></span>
<span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_condaenv</a></span><span class="op">(</span><span class="st">"EWSNET_env"</span><span class="op">)</span> <span class="co">#redundant step necessary for RMarkdown</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_config.html" class="external-link">py_config</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co">#confirm that "EWSNET_env" has been loaded</span></span>
<span><span class="co">#&gt; python:         /Users/ul20791/Library/r-miniconda-arm64/envs/EWSNET_env/bin/python</span></span>
<span><span class="co">#&gt; libpython:      /Users/ul20791/Library/r-miniconda-arm64/envs/EWSNET_env/lib/libpython3.8.dylib</span></span>
<span><span class="co">#&gt; pythonhome:     /Users/ul20791/Library/r-miniconda-arm64/envs/EWSNET_env:/Users/ul20791/Library/r-miniconda-arm64/envs/EWSNET_env</span></span>
<span><span class="co">#&gt; version:        3.8.13 | packaged by conda-forge | (default, Mar 25 2022, 06:05:16)  [Clang 12.0.1 ]</span></span>
<span><span class="co">#&gt; numpy:          /Users/ul20791/Library/r-miniconda-arm64/envs/EWSNET_env/lib/python3.8/site-packages/numpy</span></span>
<span><span class="co">#&gt; numpy_version:  1.23.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; NOTE: Python version was forced by use_python function</span></span>
<span></span>
<span><span class="va">py_packages</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_list_packages.html" class="external-link">py_list_packages</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#list all packages currently loaded in to "EWSNET_env"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">py_packages</span><span class="op">)</span></span>
<span><span class="co">#&gt;           package   version               requirement     channel</span></span>
<span><span class="co">#&gt; 1         absl-py     1.1.0             absl-py=1.1.0        pypi</span></span>
<span><span class="co">#&gt; 2       alabaster    0.7.12          alabaster=0.7.12        pypi</span></span>
<span><span class="co">#&gt; 3      astunparse     1.6.3          astunparse=1.6.3        pypi</span></span>
<span><span class="co">#&gt; 4           babel    2.10.3              babel=2.10.3        pypi</span></span>
<span><span class="co">#&gt; 5           bzip2     1.0.8               bzip2=1.0.8 conda-forge</span></span>
<span><span class="co">#&gt; 6 ca-certificates 2022.6.15 ca-certificates=2022.6.15 conda-forge</span></span>
<span></span>
<span><span class="va">skylark_ewsnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ewsnet_predict.html">ewsnet_predict</a></span><span class="op">(</span><span class="va">skylark_data</span><span class="op">$</span><span class="va">abundance</span>, noise_type <span class="op">=</span> <span class="st">"W"</span>, ensemble <span class="op">=</span> <span class="fl">25</span>, envname <span class="op">=</span> <span class="st">"EWSNET_env"</span><span class="op">)</span> <span class="co">#perform EWSNet assessment using white noise and all 25 models. The envname should match ewsnet_init()</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">skylark_ewsnet</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  pred no_trans_prob smooth_trans_prob critical_trans_prob</span></span>
<span><span class="co">#&gt; 1 Critical Transition  0.0001411155         0.2852249           0.7146339</span></span></code></pre></div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Baruah, G., Clements, C.F., Guillaume, F. &amp; Ozgul, A. (2019) When do shifts in trait dynamics precede population declines? <em>The American Naturalist</em>, 193, 633–644. <a href="https://www.journals.uchicago.edu/doi/10.1086/702849" class="external-link">doi:10.1086/702849</a></p>
<p>Clements, C.F. &amp; Ozgul, A. (2016) Including trait-based early warning signals helps predict population collapse. <em>Nature Communications</em>, 7, 10984. <a href="https://www.nature.com/articles/ncomms10984" class="external-link">doi:10.1038/ncomms10984</a></p>
<p>Clements, C.F., McCarthy, M.A. &amp; Blanchard, J.L. (2019) Early warning signals of recovery in complex systems. <em>Nature Communications</em>, 10, 1681. <a href="https://www.nature.com/articles/s41467-019-09684-y" class="external-link">doi:10.1038/s41467-019-09684-y</a></p>
<p>Dakos V., Carpenter S.R., Brock W.A., Ellison A.M., Guttal V., <em>et al.</em> (2012) Methods for detecting early warnings of critical transitions in time series illustrated using simulated ecological data. <em>PLOS ONE</em>, 7, 7:e41010. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0041010" class="external-link">doi:10.1371/journal.pone.0041010</a></p>
<p>Deb S., Sidheekh S., Clements C.F., Krishnan N.C. &amp; Dutta P.S. (2022) Machine learning methods trained on simple models can predict critical transitions in complex natural systems. <em>Royal Society Open Science</em>, 9, 211475. <a href="https://royalsocietypublishing.org/doi/10.1098/rsos.211475" class="external-link">doi:10.1098/rsos.211475</a></p>
<p>Drake, J. &amp; Griffen, B. (2010) Early warning signals of extinction in deteriorating environments. <em>Nature</em>, 467, 456–459. <a href="https://www.nature.com/articles/nature09389" class="external-link">doi:10.1038/nature09389</a></p>
<p>O’Brien, D.A., Taylor, M.L., Masonjones, H.D., Boersch-Supan P.H. &amp; O’Shea, O.R. (2020) Drivers of octopus abundance and density in an anchialine lake: a 30 year comparison. <em>Journal of Experimental Marine Biology and Ecology</em>, 528, 151377. <a href="https://www.sciencedirect.com/science/article/pii/S0022098120300356" class="external-link">doi:10.1016/j.jembe.2020.151377</a></p>
<p>Weinans, E., Quax, R., van Nes, E.H. &amp; van de Leemput, I.A. (2021) Evaluating the performance of multivariate indicators of resilience loss. <em>Scientific Reports</em>, 11, 9148. <a href="https://www.nature.com/articles/s41598-021-87839-y" class="external-link">10.1038/s41598-021-87839-y</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/duncanobrien/EWSmethods/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/duncanobrien/EWSmethods/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing EWSmethods</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Duncan O'Brien <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-3420-5210" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Smita Deb <br><small class="roles"> Author </small>  </li>
<li>Christopher Clements <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-5677-5401" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://zenodo.org/badge/latestdoi/462774077" class="external-link"><img src="https://zenodo.org/badge/462774077.svg" alt="DOI"></a></li>
<li><a href="https://github.com/duncanobrien/EWSmethods/actions" class="external-link"><img src="https://github.com/duncanobrien/EWSmethods/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Duncan O’Brien, Smita Deb, Christopher Clements.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
